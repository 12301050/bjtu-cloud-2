<!DOCTYPE html>
<html lang="en" style="height: 100%;margin: 0;padding: 0;">
<head>
  <meta charset="utf-8">
  <meta name="viewport"    content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author"      content="Sergey Pozhilov (GetTemplate.com)">
  <title>话费申报系统</title>
  <link rel="shortcut icon" href="assets/images/gt_favicon.png">
  <link rel="stylesheet" media="screen" href="assets/css/googleapi.css">
  <link rel="stylesheet" href="assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/css/font-awesome.min.css">
  <!-- Custom styles for our template -->
  <link rel="stylesheet" href="assets/css/bootstrap-theme.css" media="screen" >
  <link rel="stylesheet" href="assets/css/main.css">

  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
  <script src="assets/js/html5shiv.js"></script>
  <script src="assets/js/respond.min.js"></script>
  <![endif]-->
  <style type="text/css">
    .a-upload {
      padding: 4px 10px;
      height: 30px;
      line-height: 20px;
      position: relative;
      cursor: pointer;
      color: #888;
      background: #fafafa;
      border: 1px solid #ddd;
      border-radius: 4px;
      overflow: hidden;
      display: inline-block;
      *display: inline;
      *zoom: 1
    }
    span.time{
      color:#87C3C3;
      margin-left: 3%;
      text-align: start;
      display: block;
    }
    .a-upload  input {
      position: absolute;
      font-size: 100px;
      right: 0;
      top: 0;
      opacity: 0;
      filter: alpha(opacity=0);
      cursor: pointer
    }

    .a-upload:hover {
      color: #444;
      background: #eee;
      border-color: #ccc;
      text-decoration: none
    }
    a.cardlistitem {
      display: block;
      height: 10%;
      position: relative;
      cursor: pointer;
      background:gainsboro;
      border-radius:5px;
      margin-top:5%;
    }
    div.title {
    }
  </style>
</head>
<body style="height: 100%;margin: 0;padding: 0;">
<!-- container -->
<div class="container" style="min-height: 100%;height: auto !important;height: 100%; ">
  <div class="row">
    <!-- Article main content -->
    <article class="col-xs-12 maincontent">
      <header class="page-header" style="margin-top: 0px;margin-bottom: 0px;text-align: center;">
        <h3 class="page-title" style="font-weight:bold;">查询/登记收款</h3>
      </header>
      <div class="col-md-6 col-md-offset-3 col-sm-8 col-sm-offset-2">
        <div class="panel panel-default">
          <div class="panel-body">
            <h3 class="thin text-center" id="title" style="margin-top: 0px;margin-bottom: 0px;"></h3>
            <hr>
            <form style="text-align: -webkit-right;position: relative;" id="submitform" >
              <!--<div id="showdetails">
                <span class="time" style="text-align: start;display: block;">中国移动北京分公司</span>
                <span class="time" style="text-align: start;display: block;">2016/3/24</span>
                <span class="time" style="text-align: start;display: block;">收款额：200000</span>
                <span class="time" style="text-align: start;display: block;">备注：</span>
              </div>-->
              <div id="inputform" >
                <div class="top-margin">
                  <input type="text" id="inputtext" placeholder="请在此输入备注" class="form-control">
                </div>

              </div>
              <button  class="btn btn-action" value="保存" type="button" id="buttonforsubmit"  style="margin-top: 3%;padding-left: 20px;padding-right: 20px;padding-top: 5px;padding-bottom: 5px;"/>保存</button>
              <!--<input  class="btn btn-action" value="保存" type="button" id="buttonforsubmit"  style="margin-top: 3%;padding-left: 20px;padding-right: 20px;padding-top: 5px;padding-bottom: 5px;"/>-->

              <!--<button  class="btn btn-action" id="buttonforsubmit"  style="margin-top: 3%;padding-left: 20px;padding-right: 20px;padding-top: 5px;padding-bottom: 5px;">保存</button>-->
            </form>
            <div id="shownotes">
              <!--<a class="cardlistitem" style="margin-bottom: 5%;background:seashell;">
                            <div class="title" >
                <br>
                               <span class="time" style="text-align: start;display: block;">这是第一个备注</span>
                   <span class="time" style="text-align: start;display: block;">2016/3/24  &nbsp9:46:00 &nbsp王阿星登记 </span>
                   <br>
                            </div>
                   </a>-->
            </div>
          </div>
        </div>
      </div>
    </article>
    <!-- /Article -->
  </div>
</div>	<!-- /container -->

<footer id="footer" class="top-space" style="margin-top: 0px;position: relative;bottom: 0px;width: 100%;clear: both;margin-top: -166px;">

  <div class="footer1">
    <div class="container">
      <div class="row">

        <div class="col-md-3 widget">
          <h3 class="widget-title">Contact</h3>
          <div class="widget-body">
            <p>+234 23 9873237<br>
              <a href="mailto:#">some.email@somewhere.com</a><br>
              <br>
              234 Hidden Pond Road, Ashland City, TN 37015
            </p>
          </div>
        </div>

      </div> <!-- /row of widgets -->
    </div>
  </div>


</footer>
<script src="assets/js/jquery.js"></script>
<script src="assets/js/bootstrap.js"></script>
<script src="assets/js/headroom.min.js"></script>
<script src="assets/js/jQuery.headroom.min.js"></script>
<script src="assets/js/template.js"></script>

<script type="text/javascript">

  var reg = new RegExp("(^|&)" + "id" + "=([^&]*)(&|$)");
  var id = window.location.search.substr(1).match(reg);
  var receiptNumber=id[2];
  var paramData = {
    receiptNumber:receiptNumber};

  $.ajax({//根据合同编号获取合同信息
    /*url: "http:localhost:8080/api/order/getViewByUserName", type: "GET",//getlist的接口
     data:paramData,*/
    type :"GET",
    async:true,
    cache: false,
    data :paramData,
    timeout:300000,
    contentType: "application/x-www-form-urlencoded",
    url : "http://erpconfirm.nsfocus.com:8080/api/order/getOne",
    dataType:"json",
    success: function (data) {
      //alert(data.data[0].userName);
      if (data.ret == 0) {
        //        alert("修改成功");
        var tableStr="";
        var len = data.data.length;
        $("#title").html(data.data.receiptNumber);

        tableStr = tableStr+"<span class=\"time\" style=\"text-align: start;display: block;\">"+data.partyName+"</span>"+
            "<span class=\"time\" style=\"text-align: start;display: block;\">"+data.receiptDate+"</span>"+
            "<span class=\"time\" style=\"text-align: start;display: block;\">"+data.amount+"</span>"+
            "<span class=\"time\" style=\"text-align: start;display: block;\">备注：</span>";

        $("#showdetails").html(tableStr);
      }
      else {
        bootAlert(data.msg);
      }
    }
  });
  $.ajax({//用来请求本合同对应的所有备注信息
    /*url: "http:localhost:8080/api/order/getViewByUserName", type: "GET",//getlist的接口
     data:paramData,*/
    type :"POST",
    async:true,
    data :paramData,
    timeout:300000,
    contentType: "application/x-www-form-urlencoded",
    url : "http://erpconfirm.nsfocus.com:8080/api/order/queryNote",
    dataType:"json",
    success: function (data) {
      //alert(data.data[0].userName);
      var data=data;
      if (data.ret == 0) {
        // alert("修改成功");
        var tableStr="";
        var len = data.data.length;

        for(var i=0 ;i<len ; i++){
          tableStr = tableStr+"<a class=\"cardlistitem\" style=\"margin-bottom: 5%;background:seashell;\">"+
              "<div class=\"title\" ><br><span class=\"time\" style=\"text-align: start;display: block;\">"+data.data[i].note+"</span>"+
              "<span class=\"time\" style=\"text-align: start;display: block;\">2016/3/24  &nbsp9:46:00 &nbsp王阿星登记 </span>"+
              "<br></div></a>";
        }
        $("#shownotes").html(tableStr);
      }
      else {
        alert(data.msg);
      }
    }
  });
  $("#buttonforsubmit").click(function(){
    alert($("#inputtext").val());
    var paramNote={receiptNumber:receiptNumber,notecontent:$("#inputtext").val()};
    $.ajax({//用来传送销售经理填写的备注信息

      /*url: "http:localhost:8080/api/order/getViewByUserName", type: "GET",//getlist的接口
       data:paramData,*/
      type :"POST",//记得留意
      async:false,
      data :paramNote,
      timeout:300000,
      contentType: "application/x-www-form-urlencoded",
      url : "http://erpconfirm.nsfocus.com:8080/api/order/addNote",
      dataType:"json",
      success: function (data) {//返回给我所有的备注信息，静态刷新
        //alert(data.data[0].userName);
        var data=data;
        if (data.ret == 0) {
          /*window.location.href="http://baidu.com?id="+receiptNumber;*/


          //window.location.reload();
          alert("添加成功！");
          var tableStr="";
          var len = data.data.length;

          for(var i=0 ;i<len ; i++){
            tableStr = tableStr+"<a class=\"cardlistitem\" style=\"margin-bottom: 5%;background:seashell;\">"+
                "<div class=\"title\" ><br><span class=\"time\" style=\"text-align: start;display: block;\">"+data.data[i].note+"</span>"+
                "<span class=\"time\" style=\"text-align: start;display: block;\">2016/3/24  &nbsp9:46:00 &nbsp王阿星登记 </span>"+
                "<br></div></a>";
          }
          $("#shownotes").html(tableStr);
          document.getElementById("inputtext").value="";

        }
        else {
          alert(data.msg);
        }
      }
    });
  });
</script>
<!-- JavaScript libs are placed at the end of the document so the pages load faster -->
</body>
</html>